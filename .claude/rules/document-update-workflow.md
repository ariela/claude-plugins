# ドキュメント自動更新ワークフロー

このファイルは、ClaudeCodeがプロジェクト知識を体系的に管理し、既存ドキュメントに反映させるためのワークフローを定義します。

## 📌 基本方針

開発中に得られた知識を**失わず**、**再利用可能な形**で蓄積することを目的とします。

## 🔄 更新フロー

### ステップ1: 知識の発見を認識

以下の状況で更新提案を検討してください：

| 状況 | 更新対象ファイル | 優先度 |
|------|------------------|--------|
| エラーを解決した | `troubleshooting.md` | 高 |
| 実装パターンを確立した | `patterns.md` | 中 |
| API使用法を確認した | `coding-standards.md` | 中 |
| プロジェクト固有の決定事項 | `project-memory.md` | 高 |
| ドキュメントの誤りを発見 | 該当ファイル | 高 |

### ステップ2: 提案の提示

以下のフォーマットでユーザーに提案してください：

```
💡 ドキュメント更新の提案

【発見内容】
[何を発見・解決したか]

【記録すべき情報】
- ポイント1
- ポイント2
- ポイント3

【更新候補ファイル】
1. .claude/rules/[ファイル名] - [理由]
2. .claude/rules/[ファイル名] - [理由]
3. 新規ファイル作成: [ファイル名] - [理由]

どこに追加しますか？（番号を選択、複数選択可: "1,2" / "all" / "skip"）
```

### ステップ3: 内容のプレビュー

ユーザーが選択した後、実際の更新内容をプレビュー表示：

```markdown
【更新プレビュー】
ファイル: .claude/rules/[ファイル名]

追加する内容:
---
## [セクション名]（更新日: YYYY-MM-DD）

[実際の内容]

### 関連情報
- [関連する既存セクションへのリンク]
---

この内容で更新しますか？ (yes / edit / no)
```

### ステップ4: 更新の実行

- `yes`: そのまま更新
- `edit`: ユーザーが内容を編集してから更新
- `no`: 更新をキャンセル

## ✍️ 書式ルール

### 日付の記録

すべての更新には日付を含めてください：

```markdown
## セクション名（更新日: 2026-01-02）
```

### 既存内容の保持

- 既存セクションを削除しない
- 既存内容と矛盾する場合は、ユーザーに確認
- 追加のみを行う（上書きしない）

### スタイルの踏襲

- 既存ファイルの見出しレベルに合わせる
- 箇条書き/番号付きリストの形式を統一
- コードブロックの言語指定を明記

## 📂 ファイル選択のガイドライン

### coding-standards.md
- コーディング規約
- 命名規則
- フォーマットルール
- 言語/フレームワーク固有のベストプラクティス

### troubleshooting.md
- エラーメッセージと解決策
- よくある問題と回避策
- デバッグ手法
- 環境依存の問題

### patterns.md
- 設計パターン
- 実装パターン
- アーキテクチャ決定
- リファクタリング知見

### project-memory.md
- プロジェクト固有の制約
- 重要な技術選定の理由
- チーム合意事項
- 依存関係の管理方針

## 🚫 記録してはいけない情報

以下の情報は**絶対に**ドキュメントに記録しないでください：

- ❌ APIキー、シークレットキー、トークン
- ❌ パスワード、認証情報
- ❌ 個人情報（メールアドレス、電話番号等）
- ❌ 機密性の高いビジネスロジック（ユーザーが明示的に許可した場合を除く）

## 🔄 定期的な見直し

以下の場合、ドキュメント構造の見直しを提案してください：

1. 単一ファイルが100行を超えた → 分割を提案
2. 同じ内容を複数回参照した → 独立セクション化を提案
3. 複数ファイルにまたがる内容 → 統合または相互参照を提案

## 🎯 成功の指標

このワークフローが機能している場合：

- ✅ 同じエラーを二度調査しなくて済む
- ✅ 過去の実装パターンを素早く参照できる
- ✅ 新しいチームメンバーがドキュメントから学べる
- ✅ プロジェクトの技術的決定の理由が追跡できる
